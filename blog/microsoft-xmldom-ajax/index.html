
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
  <head>
    <!-- include head -->
    

<meta charset="utf-8">
<title>通过Microsoft.XMLDOM实现简单的Ajax（更新） - 李华顺</title>
<meta name="author" content="Jason Lee">
<meta name="description"
      content="通过Microsoft.XMLDOM实现简单的Ajax（更新） 今天在在做公司的搜索关键词功能，因为哪个页面要做成静态HTML的，所以想了几个方法，昨天晚上快下班的时候上头才说要改，就急急忙忙地改了一下，实现的方法是用 来读这些动态的数据，但是因为页面上搜索有条件，切换条件是直接用js来处理的， &hellip;">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="no">
<meta content='True' name='HandheldFriendly' />
<link rel="canonical" href="http://huacnlee.github.com/blog/microsoft-xmldom-ajax">
<link href="/favicon.ico" rel="icon">
<link href="/stylesheets/screen.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css">

<script src="/javascripts/modernizr-2.0.js" type="text/javascript"></script>
<script src="/javascripts/ender.js" type="text/javascript"></script>
<script src="/javascripts/octopress.js" type="text/javascript"></script>


<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9745660-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +
      '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


    <!-- /include -->
  </head>
  <body>
    <div id="wrapper">

      <header role="banner" class="site_metas">
	<!-- include header -->
	
<hgroup>
  <h1><a href="/">李华顺</a></h1>
  
  <div class="nav">
    <a href="/">About</a> /
    <a href="/work">Work</a> /
    <a href="/blog/archives">Blog</a> /
    <a href="https://github.com/huacnlee">GitHub</a>
  </div>
</hgroup>

	<!-- /include -->
        <!-- include social_service_links -->
	
        <!-- /include -->
      </header>

      <div id="content">
	<!-- content -->
	


<article class="entry" role="article">

  <header>
    <h1 class="entry_title">通过 Microsoft.XMLDOM 实现简单的 Ajax（更新）</h1>
    
  </header>

  <div class="entry_content"><p>今天在在做公司的搜索关键词功能，因为哪个页面要做成静态 HTML 的，所以想了几个方法，昨天晚上快下班的时候上头才说要改，就急急忙忙地改了一下，实现的方法是用<span style="COLOR: #3366ff">
<script src="动太态面+参数" type="text/javascript"></script>
</span>来读这些动态的数据，但是因为页面上搜索有条件，切换条件是直接用 js 来处理的，所以，在切换的时候，热门关键词都要跟在改变。但问题随之而来！<span> 这</span>个区域我没有办法在页面不刷新的情况下重新调用它。所以一直没有解决。<br />今天试着被调用的态页面反回 XML 结构的，再用 Js 去读这个结果，再输入，果然成功了。呵呵，也就是一个简单的 Ajax 应用。<br /><br />动态页面生成 XML 的代码：</p>


<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; font-size: 13px; width: 98%; background-color: #eeeeee;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" border="0" align="top" /><span style="COLOR: #0000ff">protected</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #0000ff">void</span><span style="COLOR: #000000">&nbsp;Page_Load(</span><span style="COLOR: #0000ff">object</span><span style="COLOR: #000000">&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><img src="http://www.cnblogs.com/Images/dot.gif" border="0" /></span><span><span style="COLOR: #000000">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.ContentType&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">text/xml</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" border="0" align="top" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">生成 XML</span><span style="DISPLAY: none"><span style="COLOR: #0000ff">#region</span><span style="COLOR: #000000">&nbsp;生成 XML</span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #0000ff">void</span><span style="COLOR: #000000">&nbsp;CreateXML()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><img src="http://www.cnblogs.com/Images/dot.gif" border="0" /></span><span><span style="COLOR: #000000">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000">&nbsp;strContent&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;&#8221;</span><span style="COLOR: #000000">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">for</span><span style="COLOR: #000000">&nbsp;(</span><span style="COLOR: #0000ff">int</span><span style="COLOR: #000000">&nbsp;i&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">;&nbsp;i&nbsp;</span><span style="COLOR: #000000">&lt;</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">100</span><span style="COLOR: #000000">;&nbsp;i</span><span style="COLOR: #000000">++</span><span style="COLOR: #000000">)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><img src="http://www.cnblogs.com/Images/dot.gif" border="0" /></span><span><span style="COLOR: #000000">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strContent&nbsp;</span><span style="COLOR: #000000">+=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"><![CDATA[</span><span style="COLOR: #000000" mce_style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000" mce_style="COLOR: #000000"> </span><span style="COLOR: #000000" mce_style="COLOR: #000000">+</span><span style="COLOR: #000000" mce_style="COLOR: #000000"> </span><span style="COLOR: #000000" mce_style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000" mce_style="COLOR: #000000">关键词</span><span style="COLOR: #000000" mce_style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000" mce_style="COLOR: #000000"> </span><span style="COLOR: #000000" mce_style="COLOR: #000000">+</span><span style="COLOR: #000000" mce_style="COLOR: #000000"> i.ToString() </span><span style="COLOR: #000000" mce_style="COLOR: #000000">+</span><span style="COLOR: #000000" mce_style="COLOR: #000000"> </span><span style="COLOR: #000000" mce_style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000" mce_style="COLOR: #000000">]]></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&nbsp;i.ToString()&nbsp;</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteXML(strContent);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">#endregion</span></span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" border="0" align="top" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">输出 XML</span><span style="DISPLAY: none"><span style="COLOR: #0000ff">#region</span><span style="COLOR: #000000">&nbsp;输出 XML</span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #0000ff">void</span><span style="COLOR: #000000">&nbsp;WriteXML(</span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000">&nbsp;strContent)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><img src="http://www.cnblogs.com/Images/dot.gif" border="0" /></span><span><span style="COLOR: #000000">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&nbsp;strContent&nbsp;</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">#endregion</span></span></div>


<p><br /><br />返回的 XML 代码结构：</p>


<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; font-size: 13px; width: 98%; background-color: #eeeeee;"><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">keywords</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">关键词 1</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">1</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">关键词 2</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">2</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">关键词 2</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">2</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">关键词 4</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">4</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">关键词 5</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">word</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000">5</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">type</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">item</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br /></span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">keywords</span><span style="COLOR: #0000ff">&gt;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></div>


<p><br /><br />Javascript 读取的方法，FileName 参数是被调用的动态页面，panelID 是最终要显示的区域 ID 名称<br />重点：xmlDoc.async<span style="COLOR: #000000">=&#8221;</span><span style="COLOR: #0000ff">false&#8221;</span><span style="COLOR: #000000">; 异步方式读取</span></p>


<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; font-size: 13px; width: 98%; background-color: #eeeeee;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" border="0" align="top" /><span style="COLOR: #000000">&nbsp;&nbsp;</span><span style="COLOR: #0000ff">function</span><span style="COLOR: #000000">&nbsp;ReadKeywords(filename,panelID)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><img src="http://www.cnblogs.com/Images/dot.gif" border="0" /></span><span><span style="COLOR: #000000">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">var</span><span style="COLOR: #000000">&nbsp;panel&nbsp;&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;$(panelID);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">取得取后输出的区域，来自参数</span><span style="COLOR: #008000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /></span><span style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">var</span><span style="COLOR: #000000">&nbsp;strContent&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;&#8221;</span><span style="COLOR: #000000">;&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.innerHTML&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">载入中<img src="http://www.cnblogs.com/Images/dot.gif" border="0" /></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">var</span><span style="COLOR: #000000">&nbsp;xmlDoc&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #0000ff">new</span><span style="COLOR: #000000">&nbsp;ActiveXObject(</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">Microsoft.XMLDOM</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlDoc.async</span><span style="COLOR: #000000">=&#8221;</span><span style="COLOR: #0000ff">false&#8221;</span><span style="COLOR: #000000">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">去读用动态页面，并读到结果的 XML</span><span style="COLOR: #008000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /></span><span style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlDoc.load(filename);&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">选定节点</span><span style="COLOR: #008000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /></span><span style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">var</span><span style="COLOR: #000000">&nbsp;item&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;xmlDoc.selectNodes(</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">keywords/item</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">);&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">没内容时的处理&nbsp;&nbsp;</span><span style="COLOR: #008000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /></span><span style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">(item&nbsp;</span><span style="COLOR: #000000">==</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #0000ff">null</span><span style="COLOR: #000000">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">(item.length&nbsp;</span><span style="COLOR: #000000">==</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">)&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">通过循环组合内容</span><span style="COLOR: #008000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /></span><span style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">for</span><span style="COLOR: #000000">(</span><span style="COLOR: #0000ff">var</span><span style="COLOR: #000000">&nbsp;i</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">;i</span><span style="COLOR: #000000">&lt;</span><span style="COLOR: #000000">item.length;i</span><span style="COLOR: #000000">++</span><span style="COLOR: #000000">)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" border="0" align="top" /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><img src="http://www.cnblogs.com/Images/dot.gif" border="0" /></span><span><span style="COLOR: #000000">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strContent&nbsp;</span><span style="COLOR: #000000">+=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"><span></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strContent&nbsp;</span><span style="COLOR: #000000">+=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&nbsp;item[i].selectSingleNode(</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">word</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">).text</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">&amp;type=</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">item[i].selectSingleNode(</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">type</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">).text</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">&rsquo;&gt;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&nbsp;item[i].selectSingleNode(</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">word</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">).text</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"></span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strContent&nbsp;</span><span style="COLOR: #000000">+=</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000"></span>&nbsp;</span><span style="COLOR: #000000">&#8221;</span><span style="COLOR: #000000">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">显示到区域上面</span><span style="COLOR: #008000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" border="0" align="top" /></span><span style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.innerHTML&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;strContent;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" border="0" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" border="0" align="top" /></span></div>


<p><br />HTML 调用的代码：</p>


<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; font-size: 13px; width: 98%; background-color: #eeeeee;"><span style="COLOR: #000000">//说明：<br />//现在以上面的&nbsp;动态页面命名为&nbsp;&#8221;<span style="COLOR: red">getkeyword.aspx</span>&#8220;&nbsp;，Javascript 存成&nbsp;<span style="COLOR: #0000ff">Script.js<br /></span>//HTML 调用时的例子<br /></span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">script&nbsp;</span><span style="COLOR: #ff0000">type</span><span style="COLOR: #0000ff">=&#8221;text/javascript&#8221;</span><span style="COLOR: #ff0000">&nbsp;src</span><span style="COLOR: #0000ff">=&#8221;script.js&#8221;</span><span style="COLOR: #0000ff">&gt;<!--</span--><span style="COLOR: #800000">script</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br /></span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">div&nbsp;</span><span style="COLOR: #ff0000">id</span><span style="COLOR: #0000ff">=&#8221;panelKeyword&#8221;</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br />&nbsp;&nbsp;&nbsp;&nbsp;这个地方会显示最终的关键词<br /></span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">div</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br /></span><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">script&nbsp;</span><span style="COLOR: #ff0000">type</span><span style="COLOR: #0000ff">=&#8221;text/javascript&#8221;</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5"><br />&nbsp;&nbsp;&nbsp;&nbsp;ReadKeywords(</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&#8221;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">getkeyword.aspx</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&#8221;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">,</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&#8221;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">panelKeyword</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&#8221;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">);<br /></span><span style="COLOR: #0000ff"><!--</span--><span style="COLOR: #800000">script</span><span style="COLOR: #0000ff">&gt;</span></span></span></span></div>


<p><br /><span style="COLOR: #008000">提醒一下：HTML 与 XML 里面的代码可能会有错别字的地方，因为是用记事本打出来的，如果真的有错的地方，请大家多多包涵..本文主要是讲的方法，而不是给代码，代码拿来也没什么用，网上好的 Ajax 框架多着呢，呵呵</span><br /><br />应用效果：<a href="http://www.uctoy.com/" target="_blank">http://www.uctoy.com</a></p>


<hr />


<p><span style="font-size: x-small;"><br /></span></p>

</div>

  <footer>
    <p class="meta">

      

      
      <time datetime="2008-04-24 08:17:00 +0800" pubdate>2008-04-24</time>
      

      
      <span class="categories">
	<a class='category' href='/blog/category/javascript/'>Javascript</a>, <a class='category' href='/blog/category/xml/'>XML</a>, <a class='category' href='/blog/category/前端/'>前端</a>
      </span>
      

    </p>

    
    <div class="sharing">

      

      

      
    </div>
    

    
    <section>
      <h3 id="comments">Comments</h3>
      <div id="disqus_thread" aria-live="polite">
	<noscript>
	  Javascript not support.
	  (<a href="http://disqus.com/?ref_noscript">Disqus</a>)
	</noscript>
      </div>
    </section>
    

  </footer>

</div>

	<!-- /content -->
      </div>

      <footer role="contentinfo">
	<!-- include footer -->
	<p>
  Copyright &copy; 2019 - Jason Lee
</p>

	<!-- /include -->
      </footer>

      <!-- include after_footer -->
      

<script type="text/javascript">
      var disqus_shortname = 'huacnlee';
      
	
	// var disqus_developer = 1;
	var disqus_identifier = 'http://huacnlee.github.com/blog/microsoft-xmldom-ajax';
	var disqus_url = 'http://huacnlee.github.com/blog/microsoft-xmldom-ajax';
	var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




      <!-- /include -->

    </div>
  </body>
</html>
